<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Financial Forecast</title>
<style>
  body { font-family: 'Roboto', sans-serif; background-color: #f4f4f9; margin: 0; padding: 20px; }
  table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
  th, td { border: 1px solid #ddd; padding: 8px; text-align: center; font-size: 16px; }
  th { background-color: #457b9d; color: white; }
  td input { width: 60px; padding: 5px; box-sizing: border-box; border: 1px solid #ccc; border-radius: 4px; font-size: 16px; }
  input[type="number"] { width: 60px; }
  button { background-color: #a8dadc; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; }
  button:hover { background-color: #457b9d; }
  button + button { margin-left: 10px; }
  div { margin-bottom: 20px; }
  .readonly-cell { font-size: 16px; }
  .readonly-cell.total-expenses, .readonly-cell.net-income, .readonly-cell.cash-burndown { font-weight: bold; }
  .readonly-cell.total-expenses { background-color: #e0e0e0; }
  .readonly-cell.net-income { background-color: #d3d3d3; }
  .readonly-cell.cash-burndown { background-color: #c6c6c6; }
  #startingInvestment {
    width: 300px;
    margin-bottom: 20px;
    padding: 5px;
    box-sizing: border-box;
    border: 1px solid #ccc;
    border-radius: 10px;
    font-size: 16px;
    box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.3);
    background-color: #ffffe0;
  }
  .category { font-weight: normal; border: none; }
  .tooltip {
    position: relative;
    display: inline-block;
  }
  .tooltip:hover::after {
    content: attr(data-title);
    position: absolute;
    background-color: #FF6F61;
    color: white;
    padding: 5px;
    border-radius: 8px;
    top: -5px;
    left: 105%;
    white-space: nowrap;
    z-index: 1;
    box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
  }
  /* New CSS for Money Received section */
  .category-header {
    background-color: #f0f0f0;
    font-weight: bold;
  }
  .category-header td {
    text-align: left;
    padding-left: 10px;
  }
</style>
</head>
<body>
<div>
  <label for="startingInvestment">Starting Investment:</label>
  <input type="number" id="startingInvestment" class="starting-investment" oninput="calculateTotals()">
</div>
<div style="overflow-x:auto;">
  <table>
   <tr>
  <th>Category / Months </th>
  <th>1</th>
  <th>2</th>
  <th>3</th>
  <th>4</th>
  <th>5</th>
  <th>6</th>
  <th>7</th>
  <th>8</th>
  <th>9</th>
  <th>10</th>
  <th>11</th>
  <th>12</th>
</tr>
   <tr>
 <tr class="category-header">
  <td colspan="13"><strong>Money Received</strong></td>
</tr>
<tr>
  <td class="category tooltip" title="Revenue from product or service sales" onmouseover="disableDefaultTooltip(this)">Sales</td>
  <td><input type="number" id="sales1" oninput="calculateTotals()"></td>
  <td><input type="number" id="sales2" oninput="calculateTotals()"></td>
  <td><input type="number" id="sales3" oninput="calculateTotals()"></td>
  <td><input type="number" id="sales4" oninput="calculateTotals()"></td>
  <td><input type="number" id="sales5" oninput="calculateTotals()"></td>
  <td><input type="number" id="sales6" oninput="calculateTotals()"></td>
  <td><input type="number" id="sales7" oninput="calculateTotals()"></td>
  <td><input type="number" id="sales8" oninput="calculateTotals()"></td>
  <td><input type="number" id="sales9" oninput="calculateTotals()"></td>
  <td><input type="number" id="sales10" oninput="calculateTotals()"></td>
  <td><input type="number" id="sales11" oninput="calculateTotals()"></td>
  <td><input type="number" id="sales12" oninput="calculateTotals()"></td>
</tr>
<tr>
  <td class="category tooltip" title="Income from sources other than sales" onmouseover="disableDefaultTooltip(this)">Other Income</td>
  <td><input type="number" id="otherIncome1" oninput="calculateTotals()"></td>
  <td><input type="number" id="otherIncome2" oninput="calculateTotals()"></td>
  <td><input type="number" id="otherIncome3" oninput="calculateTotals()"></td>
  <td><input type="number" id="otherIncome4" oninput="calculateTotals()"></td>
  <td><input type="number" id="otherIncome5" oninput="calculateTotals()"></td>
  <td><input type="number" id="otherIncome6" oninput="calculateTotals()"></td>
  <td><input type="number" id="otherIncome7" oninput="calculateTotals()"></td>
  <td><input type="number" id="otherIncome8" oninput="calculateTotals()"></td>
  <td><input type="number" id="otherIncome9" oninput="calculateTotals()"></td>
  <td><input type="number" id="otherIncome10" oninput="calculateTotals()"></td>
  <td><input type="number" id="otherIncome11" oninput="calculateTotals()"></td>
  <td><input type="number" id="otherIncome12" oninput="calculateTotals()"></td>
</tr>
<tr>
  <td class="category tooltip" title="Funds received from investors" onmouseover="disableDefaultTooltip(this)">Investment Received</td>
  <td><input type="number" id="investments1" oninput="calculateTotals()"></td>
  <td><input type="number" id="investments2" oninput="calculateTotals()"></td>
  <td><input type="number" id="investments3" oninput="calculateTotals()"></td>
  <td><input type="number" id="investments4" oninput="calculateTotals()"></td>
  <td><input type="number" id="investments5" oninput="calculateTotals()"></td>
  <td><input type="number" id="investments6" oninput="calculateTotals()"></td>
  <td><input type="number" id="investments7" oninput="calculateTotals()"></td>
  <td><input type="number" id="investments8" oninput="calculateTotals()"></td>
  <td><input type="number" id="investments9" oninput="calculateTotals()"></td>
  <td><input type="number" id="investments10" oninput="calculateTotals()"></td>
  <td><input type="number" id="investments11" oninput="calculateTotals()"></td>
  <td><input type="number" id="investments12" oninput="calculateTotals()"></td>
</tr>
<tr>
<td class="category"><strong>Total Received</strong></td>
<td class="readonly-cell total-expenses" id="totalReceived1"></td>
<td class="readonly-cell total-expenses" id="totalReceived2"></td>
<td class="readonly-cell total-expenses" id="totalReceived3"></td>
<td class="readonly-cell total-expenses" id="totalReceived4"></td>
<td class="readonly-cell total-expenses" id="totalReceived5"></td>
<td class="readonly-cell total-expenses" id="totalReceived6"></td>
<td class="readonly-cell total-expenses" id="totalReceived7"></td>
<td class="readonly-cell total-expenses" id="totalReceived8"></td>
<td class="readonly-cell total-expenses" id="totalReceived9"></td>
<td class="readonly-cell total-expenses" id="totalReceived10"></td>
<td class="readonly-cell total-expenses" id="totalReceived11"></td>
<td class="readonly-cell total-expenses" id="totalReceived12"></td>
</tr>
    <tr class="category-header">
  <td colspan="13"><strong>Expenses</strong></td>
</tr>
<tr>
  <td class="category tooltip" title="Direct costs of producing goods sold" onmouseover="disableDefaultTooltip(this)">COGs</td>
  <td><input type="number" id="cogs1" oninput="calculateTotals()"></td>
  <td><input type="number" id="cogs2" oninput="calculateTotals()"></td>
  <td><input type="number" id="cogs3" oninput="calculateTotals()"></td>
  <td><input type="number" id="cogs4" oninput="calculateTotals()"></td>
  <td><input type="number" id="cogs5" oninput="calculateTotals()"></td>
  <td><input type="number" id="cogs6" oninput="calculateTotals()"></td>
  <td><input type="number" id="cogs7" oninput="calculateTotals()"></td>
  <td><input type="number" id="cogs8" oninput="calculateTotals()"></td>
  <td><input type="number" id="cogs9" oninput="calculateTotals()"></td>
  <td><input type="number" id="cogs10" oninput="calculateTotals()"></td>
  <td><input type="number" id="cogs11" oninput="calculateTotals()"></td>
  <td><input type="number" id="cogs12" oninput="calculateTotals()"></td>
</tr>
<tr>
  <td class="category tooltip" title="Monthly rent for office or workspace" onmouseover="disableDefaultTooltip(this)">Rent</td>
  <td><input type="number" id="rent1" oninput="calculateTotals()"></td>
  <td><input type="number" id="rent2" oninput="calculateTotals()"></td>
  <td><input type="number" id="rent3" oninput="calculateTotals()"></td>
  <td><input type="number" id="rent4" oninput="calculateTotals()"></td>
  <td><input type="number" id="rent5" oninput="calculateTotals()"></td>
  <td><input type="number" id="rent6" oninput="calculateTotals()"></td>
  <td><input type="number" id="rent7" oninput="calculateTotals()"></td>
  <td><input type="number" id="rent8" oninput="calculateTotals()"></td>
  <td><input type="number" id="rent9" oninput="calculateTotals()"></td>
  <td><input type="number" id="rent10" oninput="calculateTotals()"></td>
  <td><input type="number" id="rent11" oninput="calculateTotals()"></td>
  <td><input type="number" id="rent12" oninput="calculateTotals()"></td>
</tr>
<tr>
<td class="category tooltip" title="Salaries paid to employees" onmouseover="disableDefaultTooltip(this)">Salaries</td>
<td><input type="number" id="salaries1" oninput="calculateTotals()"></td>
<td><input type="number" id="salaries2" oninput="calculateTotals()"></td>
<td><input type="number" id="salaries3" oninput="calculateTotals()"></td>
<td><input type="number" id="salaries4" oninput="calculateTotals()"></td>
<td><input type="number" id="salaries5" oninput="calculateTotals()"></td>
<td><input type="number" id="salaries6" oninput="calculateTotals()"></td>
<td><input type="number" id="salaries7" oninput="calculateTotals()"></td>
<td><input type="number" id="salaries8" oninput="calculateTotals()"></td>
<td><input type="number" id="salaries9" oninput="calculateTotals()"></td>
<td><input type="number" id="salaries10" oninput="calculateTotals()"></td>
<td><input type="number" id="salaries11" oninput="calculateTotals()"></td>
<td><input type="number" id="salaries12" oninput="calculateTotals()"></td>
</tr>
<tr>
<td class="category tooltip" title="Costs for electricity, water, internet, and other basic services" onmouseover="disableDefaultTooltip(this)">Utilities</td>
<td><input type="number" id="utilities1" oninput="calculateTotals()"></td>
<td><input type="number" id="utilities2" oninput="calculateTotals()"></td>
<td><input type="number" id="utilities3" oninput="calculateTotals()"></td>
<td><input type="number" id="utilities4" oninput="calculateTotals()"></td>
<td><input type="number" id="utilities5" oninput="calculateTotals()"></td>
<td><input type="number" id="utilities6" oninput="calculateTotals()"></td>
<td><input type="number" id="utilities7" oninput="calculateTotals()"></td>
<td><input type="number" id="utilities8" oninput="calculateTotals()"></td>
<td><input type="number" id="utilities9" oninput="calculateTotals()"></td>
<td><input type="number" id="utilities10" oninput="calculateTotals()"></td>
<td><input type="number" id="utilities11" oninput="calculateTotals()"></td>
<td><input type="number" id="utilities12" oninput="calculateTotals()"></td>
</tr>
<tr>
<td class="category tooltip" title="Expenses for advertising, promotions, and other marketing activities" onmouseover="disableDefaultTooltip(this)">Marketing</td>
<td><input type="number" id="marketing1" oninput="calculateTotals()"></td>
<td><input type="number" id="marketing2" oninput="calculateTotals()"></td>
<td><input type="number" id="marketing3" oninput="calculateTotals()"></td>
<td><input type="number" id="marketing4" oninput="calculateTotals()"></td>
<td><input type="number" id="marketing5" oninput="calculateTotals()"></td>
<td><input type="number" id="marketing6" oninput="calculateTotals()"></td>
<td><input type="number" id="marketing7" oninput="calculateTotals()"></td>
<td><input type="number" id="marketing8" oninput="calculateTotals()"></td>
<td><input type="number" id="marketing9" oninput="calculateTotals()"></td>
<td><input type="number" id="marketing10" oninput="calculateTotals()"></td>
<td><input type="number" id="marketing11" oninput="calculateTotals()"></td>
<td><input type="number" id="marketing12" oninput="calculateTotals()"></td>
</tr>
<tr>
  <td class="category tooltip" title="Costs for professional services like accounting, legal, consulting" onmouseover="disableDefaultTooltip(this)">Professional Fees</td>
  <td><input type="number" id="professionalFees1" oninput="calculateTotals()"></td>
  <td><input type="number" id="professionalFees2" oninput="calculateTotals()"></td>
  <td><input type="number" id="professionalFees3" oninput="calculateTotals()"></td>
  <td><input type="number" id="professionalFees4" oninput="calculateTotals()"></td>
  <td><input type="number" id="professionalFees5" oninput="calculateTotals()"></td>
  <td><input type="number" id="professionalFees6" oninput="calculateTotals()"></td>
  <td><input type="number" id="professionalFees7" oninput="calculateTotals()"></td>
  <td><input type="number" id="professionalFees8" oninput="calculateTotals()"></td>
  <td><input type="number" id="professionalFees9" oninput="calculateTotals()"></td>
  <td><input type="number" id="professionalFees10" oninput="calculateTotals()"></td>
  <td><input type="number" id="professionalFees11" oninput="calculateTotals()"></td>
  <td><input type="number" id="professionalFees12" oninput="calculateTotals()"></td>
</tr>
<tr>
<td class="category tooltip" title="Costs for other expenses incurred that are not captured elsewhere" onmouseover="disableDefaultTooltip(this)">Other</td>
<td><input type="number" id="other1" oninput="calculateTotals()"></td>
<td><input type="number" id="other2" oninput="calculateTotals()"></td>
<td><input type="number" id="other3" oninput="calculateTotals()"></td>
<td><input type="number" id="other4" oninput="calculateTotals()"></td>
<td><input type="number" id="other5" oninput="calculateTotals()"></td>
<td><input type="number" id="other6" oninput="calculateTotals()"></td>
<td><input type="number" id="other7" oninput="calculateTotals()"></td>
<td><input type="number" id="other8" oninput="calculateTotals()"></td>
<td><input type="number" id="other9" oninput="calculateTotals()"></td>
<td><input type="number" id="other10" oninput="calculateTotals()"></td>
<td><input type="number" id="other11" oninput="calculateTotals()"></td>
<td><input type="number" id="other12" oninput="calculateTotals()"></td>
</tr>
  </tr>
<td class="category"><strong>Total Expenses</strong></td>
<td class="readonly-cell total-expenses" id="totalExpenses1"></td>
<td class="readonly-cell total-expenses" id="totalExpenses2"></td>
<td class="readonly-cell total-expenses" id="totalExpenses3"></td>
<td class="readonly-cell total-expenses" id="totalExpenses4"></td>
<td class="readonly-cell total-expenses" id="totalExpenses5"></td>
<td class="readonly-cell total-expenses" id="totalExpenses6"></td>
<td class="readonly-cell total-expenses" id="totalExpenses7"></td>
<td class="readonly-cell total-expenses" id="totalExpenses8"></td>
<td class="readonly-cell total-expenses" id="totalExpenses9"></td>
<td class="readonly-cell total-expenses" id="totalExpenses10"></td>
<td class="readonly-cell total-expenses" id="totalExpenses11"></td>
<td class="readonly-cell total-expenses" id="totalExpenses12"></td>
</tr>
<tr>
<td class="category"><strong>Net Income</strong></td>
<td class="readonly-cell net-income" id="netIncome1"></td>
<td class="readonly-cell net-income" id="netIncome2"></td>
<td class="readonly-cell net-income" id="netIncome3"></td>
<td class="readonly-cell net-income" id="netIncome4"></td>
<td class="readonly-cell net-income" id="netIncome5"></td>
<td class="readonly-cell net-income" id="netIncome6"></td>
<td class="readonly-cell net-income" id="netIncome7"></td>
<td class="readonly-cell net-income" id="netIncome8"></td>
<td class="readonly-cell net-income" id="netIncome9"></td>
<td class="readonly-cell net-income" id="netIncome10"></td>
<td class="readonly-cell net-income" id="netIncome11"></td>
<td class="readonly-cell net-income" id="netIncome12"></td>
</tr>
<tr>
<td class="category"><strong>Cash Burndown</strong></td>
<td class="readonly-cell cash-burndown" id="cashBurndown1"></td>
<td class="readonly-cell cash-burndown" id="cashBurndown2"></td>
<td class="readonly-cell cash-burndown" id="cashBurndown3"></td>
<td class="readonly-cell cash-burndown" id="cashBurndown4"></td>
<td class="readonly-cell cash-burndown" id="cashBurndown5"></td>
<td class="readonly-cell cash-burndown" id="cashBurndown6"></td>
<td class="readonly-cell cash-burndown" id="cashBurndown7"></td>
<td class="readonly-cell cash-burndown" id="cashBurndown8"></td>
<td class="readonly-cell cash-burndown" id="cashBurndown9"></td>
<td class="readonly-cell cash-burndown" id="cashBurndow10"></td>
<td class="readonly-cell cash-burndown" id="cashBurndown11"></td>
<td class="readonly-cell cash-burndown" id="cashBurndown12"></td>
</tr>
<tr>
<td class="category"><strong>Runway (Months)</strong></td>
<td class="readonly-cell runway" id="runway1"></td>
<td class="readonly-cell runway" id="runway2"></td>
<td class="readonly-cell runway" id="runway3"></td>
<td class="readonly-cell runway" id="runway4"></td>
<td class="readonly-cell runway" id="runway5"></td>
<td class="readonly-cell runway" id="runway6"></td>
<td class="readonly-cell runway" id="runway7"></td>
<td class="readonly-cell runway" id="runway8"></td>
<td class="readonly-cell runway" id="runway9"></td>
<td class="readonly-cell runway" id="runway10"></td>
<td class="readonly-cell runway" id="runway11"></td>
<td class="readonly-cell runway" id="runway12"></td>
</tr>

  </table>
</div>

<button onclick="exportToExcel()">Export to Excel</button>
<script>
function formatNumber(num) {
  return num.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
}

function calculateTotals() {
  console.log("calculateTotals function called");
  const months = ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12'];
  let startingInvestment = parseFloat(document.getElementById('startingInvestment').value) || 0;
  console.log("Starting Investment:", startingInvestment);

  months.forEach(month => {
    console.log("Processing month:", month);
    let totalReceived = 0;
    let totalExpenses = 0;

    // Calculate total received
    ['sales', 'otherIncome', 'investments'].forEach(category => {
      let element = document.getElementById(category + month);
      if (element) {
        let value = parseFloat(element.value) || 0;
        console.log(`${category}${month}:`, value);
        totalReceived += value;
      } else {
        console.error(`Element not found: ${category}${month}`);
      }
    });

    // Calculate total expenses
    ['cogs', 'rent', 'salaries', 'utilities', 'marketing', 'professionalFees', 'other'].forEach(category => {
      let element = document.getElementById(category + month);
      if (element) {
        let value = parseFloat(element.value) || 0;
        console.log(`${category}${month}:`, value);
        totalExpenses += value;
      } else {
        console.error(`Element not found: ${category}${month}`);
      }
    });

    console.log(`Month ${month} - Total Received:`, totalReceived);
    console.log(`Month ${month} - Total Expenses:`, totalExpenses);

    // Update totals in the table
    updateElement('totalReceived' + month, totalReceived.toFixed(2));
    updateElement('totalExpenses' + month, totalExpenses.toFixed(2));

    // Calculate and update net income
    let netIncome = totalReceived - totalExpenses;
    updateElement('netIncome' + month, netIncome.toFixed(2));

    // Update cash burndown
    let cashBurndown = startingInvestment + netIncome;
    updateElement('cashBurndown' + month, cashBurndown.toFixed(2));

    // Calculate and update runway
    let runway = totalExpenses > 0 ? (cashBurndown / totalExpenses).toFixed(2) : 'N/A';
    updateElement('runway' + month, runway);

    console.log(`Month ${month} calculations complete`);
  });

  console.log("calculateTotals function finished");
}

function updateElement(id, value) {
  let element = document.getElementById(id);
  if (element) {
    element.innerText = value;
  } else {
    console.error(`Element not found: ${id}`);
  }
}

// Event Listeners
document.addEventListener('DOMContentLoaded', function() {
  console.log("DOM fully loaded");
  document.querySelectorAll('input[type="number"]').forEach(input => {
    input.addEventListener('input', calculateTotals);
  });

  // Initial calculation
  calculateTotals();
});
function exportToExcel() {
  const wb = XLSX.utils.book_new();
  const ws_data = [];

  // Add Starting Investment
  const startingInvestment = parseFloat(document.getElementById('startingInvestment').value) || 0;
  ws_data.push(['Starting Investment', startingInvestment]);
  ws_data.push([]); // Empty row for spacing

  // Add headers
  ws_data.push(['Category', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12']);

  // Get table data
  const table = document.querySelector('table');
  const rows = Array.from(table.rows);

  rows.forEach((row, rowIndex) => {
    if (rowIndex <= 2) return; // Skip the first three rows (header and Money Received header)
    
    const rowData = [];
    const cells = Array.from(row.cells);

    cells.forEach((cell, cellIndex) => {
      if (cellIndex === 0) {
        rowData.push(cell.innerText.trim());
      } else {
        const input = cell.querySelector('input');
        if (input) {
          rowData.push(parseFloat(input.value) || 0);
        } else {
          // For calculated cells, use Excel formulas
          const colLetter = XLSX.utils.encode_col(cellIndex);
          
          if (row.cells[0].innerText.trim() === 'Total Received') {
            rowData.push({f: `SUM(${colLetter}4:${colLetter}6)`});
          } else if (row.cells[0].innerText.trim() === 'Total Expenses') {
            rowData.push({f: `SUM(${colLetter}10:${colLetter}16)`});
          } else if (row.cells[0].innerText.trim() === 'Net Income') {
            rowData.push({f: `${colLetter}7-${colLetter}17`});
          } else if (row.cells[0].innerText.trim() === 'Cash Burndown') {
            if (cellIndex === 1) {
              rowData.push({f: `$B$1+${colLetter}18`});
            } else {
              const prevCol = XLSX.utils.encode_col(cellIndex - 2);
              rowData.push({f: `${prevCol}19+${colLetter}18`});
            }
          } else if (row.cells[0].innerText.trim() === 'Runway (Months)') {
            rowData.push({f: `IF(${colLetter}17>0, ${colLetter}19/${colLetter}17, "N/A")`});
          } else {
            rowData.push(cell.innerText);
          }
        }
      }
    });

    ws_data.push(rowData);
  });

  // Create worksheet
  const ws = XLSX.utils.aoa_to_sheet(ws_data);

  // Set column widths
  const cols = ws_data[2].map((_, i) => ({ wch: i === 0 ? 20 : 12 }));
  ws['!cols'] = cols;

  // Define styles
  const headerStyle = { font: { bold: true }, fill: { fgColor: { rgb: "CCCCCC" } }, alignment: { horizontal: "center" } };
  const subHeaderStyle = { font: { bold: true }, fill: { fgColor: { rgb: "EEEEEE" } } };
  const totalStyle = { font: { bold: true }, fill: { fgColor: { rgb: "E6F2FF" } } };

  // Apply styles
  for (let c = 0; c < ws_data[0].length; c++) {
    const cellRef1 = XLSX.utils.encode_cell({r: 0, c: c});
    const cellRef3 = XLSX.utils.encode_cell({r: 2, c: c});
    ws[cellRef1].s = headerStyle;
    ws[cellRef3].s = headerStyle;
  }

  // Sub-headers and totals
  ['Money Received', 'Expenses', 'Total Received', 'Total Expenses', 'Net Income', 'Cash Burndown', 'Runway (Months)'].forEach(label => {
    const rowIndex = ws_data.findIndex(row => row[0] === label);
    if (rowIndex !== -1) {
      for (let c = 0; c < ws_data[rowIndex].length; c++) {
        const cellRef = XLSX.utils.encode_cell({r: rowIndex, c: c});
        ws[cellRef].s = label.includes('Total') || label === 'Net Income' || label === 'Cash Burndown' || label === 'Runway (Months)' ? totalStyle : subHeaderStyle;
      }
    }
  });

  // Add the worksheet to the workbook
  XLSX.utils.book_append_sheet(wb, ws, "Financial Forecast");

  // Generate Excel file and trigger download
  XLSX.writeFile(wb, "financial_forecast.xlsx");
}
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.5/xlsx.full.min.js"></script></body>
</html>


