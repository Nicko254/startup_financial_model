<!DOCTYPE html>

<html lang="en">

<head>

<meta charset="UTF-8">

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Financial Forecast</title>

<style>

  body { font-family: 'Roboto', sans-serif; background-color: #f4f4f9; margin: 0; padding: 20px; }

  table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }

  th, td { border: 1px solid #ddd; padding: 8px; text-align: center; font-size: 16px; }

  th { background-color: #457b9d; color: white; }

  td input { width: 60px; padding: 5px; box-sizing: border-box; border: 1px solid #ccc; border-radius: 4px; font-size: 16px; }

  input[type="number"] { width: 60px; }

  button { background-color: #a8dadc; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; }

  button:hover { background-color: #457b9d; }

  button + button { margin-left: 10px; }

  div { margin-bottom: 20px; }

  .readonly-cell { font-size: 16px; }

  .readonly-cell.total-expenses, .readonly-cell.net-income, .readonly-cell.cash-burndown { font-weight: bold; }

  .readonly-cell.total-expenses { background-color: #e0e0e0; }

  .readonly-cell.net-income { background-color: #d3d3d3; }

  .readonly-cell.cash-burndown { background-color: #c6c6c6; }

  #startingInvestment {

    width: 300px;

    margin-bottom: 20px;

    padding: 5px;

    box-sizing: border-box;

    border: 1px solid #ccc;

    border-radius: 10px;

    font-size: 16px;

    box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.3);

    background-color: #ffffe0;

  }

  .category { font-weight: normal; border: none; }

  .tooltip {

    position: relative;

    display: inline-block;

  }

  .tooltip:hover::after {

    content: attr(data-title);

    position: absolute;

    background-color: #FF6F61;

    color: white;

    padding: 5px;

    border-radius: 8px;

    top: -5px;

    left: 105%;

    white-space: nowrap;

    z-index: 1;

    box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);

  }

</style>

</head>

<body>

<div>

  <label for="startingInvestment">Starting Investment:</label>

  <input type="number" id="startingInvestment" class="starting-investment" oninput="calculateTotals()">

</div>

<div style="overflow-x:auto;">

  <table>

    <tr>

      <th>Category</th>

      <th>January</th>

      <th>February</th>

      <th>March</th>

      <th>April</th>

      <th>May</th>

      <th>June</th>

      <th>July</th>

      <th>August</th>

      <th>September</th>

      <th>October</th>

      <th>November</th>

      <th>December</th>

    </tr>

    <!-- The rest of the table rows go here, as in your original HTML -->

    <!-- ... -->

  </table>

</div>

<button onclick="calculateTotals()">Calculate Totals</button>

<button onclick="exportToExcel()">Export to Excel</button>

<script>

function calculateTotals() {

  const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];

  let startingInvestment = parseFloat(document.getElementById('startingInvestment').value) || 0;

  let cumulativeCash = startingInvestment;

 

  months.forEach(month => {

    let totalReceived = 0;

    let totalExpenses = 0;

 

    // Calculate total received

    ['moneyReceived', 'sales', 'otherIncome', 'investments'].forEach(category => {

      totalReceived += parseFloat(document.getElementById(category + month).value) || 0;

    });

 

    // Calculate total expenses

    ['cogs', 'rent', 'salaries', 'utilities', 'marketing', 'legal'].forEach(category => {

      totalExpenses += parseFloat(document.getElementById(category + month).value) || 0;

    });

 

    // Update totals in the table

    document.getElementById('totalReceived' + month).innerText = totalReceived.toFixed(2);

    document.getElementById('totalExpenses' + month).innerText = totalExpenses.toFixed(2);

 

    // Calculate and update net income

    let netIncome = totalReceived - totalExpenses;

    document.getElementById('netIncome' + month).innerText = netIncome.toFixed(2);

 

    // Update cash burndown

    cumulativeCash += netIncome;

    document.getElementById('cashBurndown' + month).innerText = cumulativeCash.toFixed(2);

 

    // Calculate and update runway

    let runway = totalExpenses > 0 ? (cumulativeCash / totalExpenses).toFixed(2) : 'N/A';

    document.getElementById('runway' + month).innerText = runway;

  });

}

 

function exportToExcel() {

  let table = document.querySelector('table');

  let rows = Array.from(table.rows);

  let csvContent = 'Category,January,February,March,April,May,June,July,August,September,October,November,December\n';

  rows.forEach(row => {

    let cells = Array.from(row.cells);

    let rowContent = cells.map(cell => {

      let input = cell.querySelector('input');

      return input ? input.value : cell.innerText;

    }).join(',');

    csvContent += rowContent + '\n';

  });

  let blob = new Blob([csvContent], { type: 'text/csv' });

  let url = URL.createObjectURL(blob);

  let a = document.createElement('a');

  a.href = url;

  a.download = 'financial_forecast.csv';

  document.body.appendChild(a);

  a.click();

  document.body.removeChild(a);

}

 

function disableDefaultTooltip(element) {

  if (!element.getAttribute('data-title')) {

    element.setAttribute('data-title', element.getAttribute('title'));

    element.removeAttribute('title');

  }

}

 

function enableDefaultTooltip(element) {

  if (element.getAttribute('data-title')) {

    element.setAttribute('title', element.getAttribute('data-title'));

    element.removeAttribute('data-title');

  }

}

 

// Add event listeners to all input fields

document.querySelectorAll('input[type="number"]').forEach(input => {

  input.addEventListener('input', calculateTotals);

});

 

// Initial calculation

calculateTotals();

</script>

</body>

</html>

 

 
